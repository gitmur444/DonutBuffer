# GTest Integration –≤ –ø—Ä–æ–µ–∫—Ç–µ DonutBuffer

## üéØ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–í –ø—Ä–æ–µ–∫—Ç DonutBuffer –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Test (GTest) –∏ CTest. –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å comprehensive —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤–∞—à–∏—Ö ring buffer'–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ CMakeLists.txt                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ ringbuffer_tests.cpp                # –ë–∞–∑–æ–≤—ã–µ unit —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ ringbuffer_concurrent_tests.cpp     # –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ ringbuffer_performance_tests.cpp    # Performance –±–µ–Ω—á–º–∞—Ä–∫–∏
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–±–æ—Ä–∫–∏

### CMake –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ GTest**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `FetchContent` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è GTest v1.14.0
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CTest**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ `gtest_discover_tests`
3. **–£—Å–ª–æ–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞ GUI**: GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è –µ—Å–ª–∏ GLFW3 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### –ù–æ–≤—ã–µ —Ü–µ–ª–∏ —Å–±–æ—Ä–∫–∏

- `ringbuffer_tests` - –±–∞–∑–æ–≤—ã–µ unit —Ç–µ—Å—Ç—ã
- `ringbuffer_concurrent_tests` - –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã  
- `ringbuffer_performance_tests` - performance –±–µ–Ω—á–º–∞—Ä–∫–∏

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
mkdir build && cd build
cmake ..
make
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

#### –ß–µ—Ä–µ–∑ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
```bash
# –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
./tests/ringbuffer_tests

# Concurrent —Ç–µ—Å—Ç—ã
./tests/ringbuffer_concurrent_tests

# Performance —Ç–µ—Å—Ç—ã (–∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏!)
./tests/ringbuffer_performance_tests
```

#### –ß–µ—Ä–µ–∑ CTest:
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
ctest

# –¢–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã
ctest -R "Basic|Concurrent|Stress"

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
ctest --output-on-failure

# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç—ã
ctest --show-only
```

## üìä –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. –ë–∞–∑–æ–≤—ã–µ Unit —Ç–µ—Å—Ç—ã (`ringbuffer_tests.cpp`)

- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏**: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è, –ø—É—Å—Ç–æ–≥–æ –±—É—Ñ–µ—Ä–∞
- **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ work-around
- **Generic —Ç–µ—Å—Ç—ã**: —Ç–µ—Å—Ç—ã –ø—Ä–∏–º–µ–Ω–∏–º—ã–µ –∫ –æ–±–µ–∏–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è–º

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:**
- `BasicProduceConsume` - –æ—Å–Ω–æ–≤–Ω–æ–π produce/consume —Ü–∏–∫–ª
- `CapacityManagement` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –µ–º–∫–æ—Å—Ç—å—é –±—É—Ñ–µ—Ä–∞
- `EmptyBufferConsume` - –ø–æ–ø—ã—Ç–∫–∞ —á—Ç–µ–Ω–∏—è –∏–∑ –ø—É—Å—Ç–æ–≥–æ –±—É—Ñ–µ—Ä–∞
- `CircularOperation` - —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `StopFlagRespected` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ stop_flag

### 2. Concurrent —Ç–µ—Å—Ç—ã (`ringbuffer_concurrent_tests.cpp`)

- **Single Producer/Single Consumer**: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π SPSC —Å—Ü–µ–Ω–∞—Ä–∏–π
- **Multiple Producers/Multiple Consumers**: MPMC —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Stress —Ç–µ—Å—Ç—ã**: –≤—ã—Å–æ–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –±—É—Ñ–µ—Ä–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ thread safety
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ—Ä—è–¥–∫–∞ –¥–∞–Ω–Ω—ã—Ö  
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–æ–º —á–∏—Å–ª–µ –ø–æ—Ç–æ–∫–æ–≤

### 3. Performance —Ç–µ—Å—Ç—ã (`ringbuffer_performance_tests.cpp`)

- **Throughput benchmarks**: –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
- **Latency measurements**: –º–µ–¥–∏–∞–Ω–∞, 95–π –∏ 99–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏
- **Scalability —Ç–µ—Å—Ç—ã**: –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–∞
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π**: MutexRingBuffer vs LockFreeRingBuffer

**–ú–µ—Ç—Ä–∏–∫–∏:**
- Operations per second
- Latency –≤ –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥–∞—Ö  
- Speedup LockFree vs Mutex
- Buffer size scalability

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
```
[==========] Running 10 tests from 4 test suites.
[  PASSED  ] 10 tests.
```

### ‚úÖ Concurrent —Ç–µ—Å—Ç—ã  
```
[==========] Running 6 tests from 4 test suites.
[  PASSED  ] 6 tests.
```

### üìà Performance insights
–ò–∑ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤–∏–¥–Ω–æ, —á—Ç–æ:
- LockFreeRingBuffer –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö
- MutexRingBuffer –∏–º–µ–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é –∑–∞–¥–µ—Ä–∂–∫—É, –Ω–æ lower throughput
- –û–±–∞ –±—É—Ñ–µ—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –≤—ã—Å–æ–∫–æ–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### Test Fixtures
- `MutexRingBufferTest` - fixture –¥–ª—è —Ç–µ—Å—Ç–æ–≤ —Å –º—å—é—Ç–µ–∫—Å–∞–º–∏
- `LockFreeRingBufferTest` - fixture –¥–ª—è lock-free —Ç–µ—Å—Ç–æ–≤  
- `RingBufferGenericTest<T>` - template fixture –¥–ª—è generic —Ç–µ—Å—Ç–æ–≤

### Parameterized —Ç–µ—Å—Ç—ã
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `TYPED_TEST_SUITE` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏:
```cpp
typedef ::testing::Types<MutexRingBuffer, LockFreeRingBuffer> RingBufferTypes;
TYPED_TEST_SUITE(RingBufferGenericTest, RingBufferTypes);
```

### –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```cpp
struct PerformanceResult {
    std::chrono::nanoseconds duration;
    size_t operations_per_second;
    size_t total_operations;
};
```

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

–¢–µ—Å—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ CI/CD:

```yaml
# –ü—Ä–∏–º–µ—Ä –¥–ª—è GitHub Actions
- name: Build and Test
  run: |
    mkdir build && cd build
    cmake ..
    make
    ctest --output-on-failure
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
```bash
# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã MutexRingBuffer
ctest -R "Mutex"

# –¢–æ–ª—å–∫–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
ctest -R "Performance"

# –ò—Å–∫–ª—é—á–∏—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
ctest -E "Performance"
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ 4 –ø–æ—Ç–æ–∫–∞
ctest -j4
```

### –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç 10 —Ä–∞–∑
ctest --repeat-until-fail 10
```

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í–∞—à –ø—Ä–æ–µ–∫—Ç DonutBuffer —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç:

‚úÖ **Comprehensive test coverage** - unit, integration, performance —Ç–µ—Å—Ç—ã  
‚úÖ **Modern C++ testing** - Google Test framework  
‚úÖ **CI/CD ready** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CTest  
‚úÖ **Performance benchmarking** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
‚úÖ **Thread safety verification** - –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–µ stress —Ç–µ—Å—Ç—ã  

–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–º–æ–∂–µ—Ç:
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
- –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å thread safety

Happy testing! üöÄ